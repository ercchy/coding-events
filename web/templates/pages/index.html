{% extends 'base.html' %}
{% load static %}
{% block title %}- Map of Events{% endblock title %}

{% block main_navigation %}{% endblock %}
{% block messages %}{% endblock %}
{% block content %}
	<div class="landing-wrapper">
		<div class="events-map-wrapper">
			<div id="events-map"></div>
		</div>
		<div class="index-heading"><h1>#codeEU Map of Events</h1></div>
		<div class="form-inline search-event-form col-md-4" role="form">
			<div class="form-group">
				<input type="text" class="form-control" id="search-event"
				       placeholder="Search for events by location" autocomplete="off" data-pjax>
				<a href="#" class="search-btn"><i class="fa fa-search"></i></a>
			</div>
		</div>
		<div class="add-event-wrapper">
			<a href="{% url 'web.add_event' %}" class="add-event-btn btn btn-primary btn-icon btn-lg fa-map-marker">
				Add Your Own Event</a>
		</div>
	</div>
	{% include 'layout/top_navigation.html' %}
	{% include 'layout/messages.html' %}
	<div class="container index-content">

		<h2>Latest #codeEU Events{% if country %} in <span id="country">{{ country.country_name }}</span>{% endif %}</h2>
		<div class="clearfix" id="events-list">
			{% if latest_events %}
			    {% include 'layout/all_events.html' %}
            {% else %}
				<p>
					No events yet. <a href="{% url 'web.guide' %}">Why don't you organize your own?</a>
				<p>
			{% endif %}
		</div>

		<div class="change-location-wrapper">
			<a class="change-country-link btn btn-sm"  id="showcountries">
				See events in other countries
			</a>
			<div id="allcountries" style="display:none" >
				{% for each_country in all_countries %}
				<a href="/{{each_country.1}}" class="country-link btn btn-primary btn-sm">{{each_country.0}}</a>
				{% endfor %}
			</div>
		</div>

		<hr />

		<h1>
			<a href="{% url 'web.guide' %}">How do I organize my own event?</a>
		</h1>

	</div>


{% endblock content %}

{% block custom_js %}
	<script type="text/javascript" src="{% static 'lib/bootstrap-sass/javascripts/bootstrap/affix.js' %}"></script>
	<script src="{% static "js/markerclusterer.js" %}"></script>
	<script src="{% static "lib//pjax/jquery.pjax.js" %}"></script>
	<script type="text/javascript"
	        src="//maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyA3XIqeAZB_JDD7qSLBeqMRp0rvD2tcCrU&sensor=false">
	</script>
	<script type="text/javascript" src="{% static 'js/cw-maps.js' %}"></script>
	<script type="text/javascript">
		Codeweek.Index.init('{{map_events|safe}}', {{ lan_lon.0 }}, {{ lan_lon.1 }})
	</script>
	<script type="text/javascript">
		var showCountries = document.getElementById('showcountries');
		showCountries.onclick = function () {
		    var div = document.getElementById('allcountries');
		    if (div.style.display !== 'none') {
		        div.style.display = 'none';
		    }
		    else {
		        div.style.display = 'block';
		    }
		};
    </script>
        
    <script src="{% static "js/endless_pagination/endless-pagination.js" %}"></script>
    <script>$.endlessPaginate();</script>

{% endblock %}
